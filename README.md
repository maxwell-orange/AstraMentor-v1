<p align="center">
  <img src="https://img.shields.io/badge/Python-3.10+-blue?style=for-the-badge&logo=python&logoColor=white" alt="Python">
  <img src="https://img.shields.io/badge/Google_AI-Gemini-4285F4?style=for-the-badge&logo=google&logoColor=white" alt="Gemini">
  <img src="https://img.shields.io/badge/License-MIT-green?style=for-the-badge" alt="License">
</p>

<h1 align="center">🌟 AstraMentor</h1>

<p align="center">
  <strong>基于双Agent架构的AI编程教学系统</strong>
</p>

<p align="center">
  让AI像真正的导师一样，根据你的水平进行个性化教学
</p>

---

## ✨ 特性亮点

<table>
<tr>
<td width="50%">

### 🎓 智能分阶段教学
根据用户掌握度自动调整教学风格，从生活类比到源码级讲解，循序渐进

</td>
<td width="50%">

### 📊 动态评分算法
采用带权重的指数移动平均(EMA)算法，精准追踪学习进度

</td>
</tr>
<tr>
<td width="50%">

### 🤖 双Agent协作
Teacher Agent负责教学，Evaluation Agent负责评估，各司其职

</td>
<td width="50%">

### 💾 状态持久化
自动保存学习进度，支持断点续学

</td>
</tr>
</table>

---

## 🏗️ 系统架构

```
┌─────────────────────────────────────────────────────────────────┐
│                      AstraMentor 主控制器                        │
├─────────────────────────────────────────────────────────────────┤
│                                                                 │
│   ┌─────────────────────┐         ┌─────────────────────┐      │
│   │   🎓 Teacher Agent  │◄───────►│  📝 Evaluation Agent│      │
│   │                     │         │                     │      │
│   │  • 生成教学计划     │         │  • 评估用户回答     │      │
│   │  • 分阶段智能教学   │         │  • 计算评分         │      │
│   │  • 生成验证问题     │         │  • 更新掌握度       │      │
│   │  • 解释正确答案     │         │  • 生成进度反馈     │      │
│   └─────────────────────┘         └─────────────────────┘      │
│                                                                 │
│   ┌─────────────────────────────────────────────────────────┐  │
│   │              📚 LearnerState 学习者状态管理              │  │
│   │   知识点管理  •  掌握度跟踪  •  历史记录  •  自动持久化   │  │
│   └─────────────────────────────────────────────────────────┘  │
│                                                                 │
└─────────────────────────────────────────────────────────────────┘
```

---

## 📖 分阶段教学策略

系统会根据用户当前的掌握度（A权重）自动选择最适合的教学风格：

| 阶段 | 掌握度 | 教学角色 | 教学特点 |
|:----:|:------:|:--------:|:---------|
| **阶段0** | 0.0 ~ 0.2 | 🌱 科普老师 | 用生活类比解释概念，禁用专业术语，消除恐惧 |
| **阶段1** | 0.2 ~ 0.5 | 📝 编程导师 | 语法讲解，提供Hello World示例，逐行解释 |
| **阶段2** | 0.5 ~ 0.8 | 💼 高级工程师 | 原理剖析，Error Handling，技术对比 |
| **阶段3** | 0.8 ~ 1.0 | 🎯 架构师 | 源码级理解，手写实现，SOTA技术探讨 |

---

## 📐 评分算法

采用 **带权重的指数移动平均 (Weighted EMA)** 算法：

```
A_new = A_old + α × (S_task × W_cap - A_old)
```

### 参数说明

| 参数 | 含义 | 范围 |
|:----:|:-----|:----:|
| `A_old` | 当前掌握度 | 0.0 ~ 1.0 |
| `A_new` | 更新后掌握度 | 0.0 ~ 1.0 |
| `α` | 学习率 | 0.2 ~ 0.4 |
| `S_task` | 本次回答评分 | 0.0 ~ 1.0 |
| `W_cap` | 任务难度上限 | 见下表 |

### 难度上限设定

| 任务类型 | 难度上限 (W_cap) | 说明 |
|:--------:|:----------------:|:-----|
| 概念问答 | 0.4 | 选择题、判断题、概念解释 |
| 代码填空 | 0.7 | 补全代码、调试修复 |
| 复杂实现 | 1.0 | 手写算法、系统设计 |

> 💡 **设计理念**: 即使用户一直做对简单题目，掌握度最多只能达到该难度上限，必须挑战更难的任务才能继续提升。

---

## 🚀 快速开始

### 环境要求

- Python 3.10+
- API代理服务（如Antigravity）或直接访问Google AI API

### 1️⃣ 克隆项目

```bash
git clone https://github.com/your-repo/AstraMentor-v1.git
cd AstraMentor-v1
```

### 2️⃣ 创建虚拟环境

```bash
# 创建虚拟环境
python -m venv .venv

# 激活虚拟环境 (Windows)
.venv\Scripts\activate

# 激活虚拟环境 (Linux/macOS)
source .venv/bin/activate
```

### 3️⃣ 安装依赖

```bash
pip install -r requirements.txt
```

### 4️⃣ 配置API密钥

复制环境变量模板并填入你的API密钥：

```bash
# Windows
copy .env.example .env

# Linux/macOS
cp .env.example .env
```

编辑 `.env` 文件：

```env
# API密钥（必填）
ASTRA_API_KEY=your-api-key-here
```

### 5️⃣ 运行程序

```bash
python main.py
```

---

## 📁 项目结构

```
AstraMentor-v1/
│
├── 📄 main.py                  # 主程序入口，工作流控制
├── 📄 config.py                # 配置管理（API、学习参数）
├── 📄 requirements.txt         # Python依赖
├── 📄 README.md                # 项目文档
├── 📄 .env.example             # 环境变量模板
├── 📄 .env                     # 环境变量配置（需自行创建）
├── 📄 .gitignore               # Git忽略规则
├── 📄 learner_state.json       # 学习状态持久化文件（自动生成）
│
├── 📂 agents/                  # Agent模块
│   ├── __init__.py
│   ├── teacher_agent.py        # 🎓 教学Agent
│   └── evaluation_agent.py     # 📝 评估Agent
│
├── 📂 core/                    # 核心模块
│   ├── __init__.py
│   ├── learner_state.py        # 学习者状态管理
│   ├── scoring.py              # 评分算法（EMA）
│   └── prompts.py              # 提示词模板
│
└── 📂 utils/                   # 工具模块
    ├── __init__.py
    └── api_client.py           # API客户端封装
```

---

## 🔄 工作流程

```
┌──────────────────────────────────────────────────────────────┐
│                         开始学习                              │
└──────────────────────────────────────────────────────────────┘
                              │
                              ▼
┌──────────────────────────────────────────────────────────────┐
│  输入: 知识点名称 + 当前掌握度(A) + 目标掌握度(B) + 备注    │
└──────────────────────────────────────────────────────────────┘
                              │
                              ▼
┌──────────────────────────────────────────────────────────────┐
│              Teacher Agent 生成教学计划                       │
└──────────────────────────────────────────────────────────────┘
                              │
                              ▼
                    ┌─────────────────┐
                    │   用户确认计划？ │
                    └─────────────────┘
                     │              │
                   接受            拒绝
                     │              │
                     ▼              ▼
              ┌──────────┐   ┌──────────────┐
              │ 开始教学  │   │ 输入修改意见 │──┐
              └──────────┘   └──────────────┘  │
                     │              ▲          │
                     │              └──────────┘
                     ▼
        ┌─────────────────────────────┐
        │                             │◄──────────────────────┐
        │   📖 按阶段进行教学讲解      │                       │
        │                             │                       │
        └─────────────────────────────┘                       │
                     │                                        │
                     ▼                                        │
        ┌─────────────────────────────┐                       │
        │   ❓ 生成验证问题            │                       │
        └─────────────────────────────┘                       │
                     │                                        │
                     ▼                                        │
        ┌─────────────────────────────┐                       │
        │   ✍️ 用户输入回答           │                       │
        └─────────────────────────────┘                       │
                     │                                        │
                     ▼                                        │
        ┌─────────────────────────────┐                       │
        │   📝 Evaluation Agent 评分   │                       │
        └─────────────────────────────┘                       │
                     │                                        │
                     ▼                                        │
        ┌─────────────────────────────┐                       │
        │   📊 更新掌握度 (A权重)      │                       │
        └─────────────────────────────┘                       │
                     │                                        │
                     ▼                                        │
              ┌─────────────┐                                 │
              │ A >= B ?    │                                 │
              └─────────────┘                                 │
               │          │                                   │
              是         否                                   │
               │          │                                   │
               ▼          └───────────────────────────────────┘
        ┌─────────────────────────────┐
        │   🎉 学习完成！              │
        └─────────────────────────────┘
```

---

## 📊 评分标准

| 分数范围 | 等级 | 描述 |
|:--------:|:----:|:-----|
| 0.0 ~ 0.2 | ❌ 未掌握 | 回答错误或不相关，存在根本性误解 |
| 0.3 ~ 0.5 | 🔰 入门 | 能回忆关键词，但逻辑混乱或有语法错误 |
| 0.6 ~ 0.8 | ✅ 熟练 | 回答正确，代码可运行，但不够精准或缺乏深度 |
| 0.9 ~ 1.0 | 🌟 精通 | 回答精准完美，符合最佳实践，展现深层理解 |

---

## 🛠️ 技术栈

| 技术 | 用途 |
|:----:|:-----|
| **Python 3.10+** | 主要开发语言 |
| **Google Generative AI** | LLM API调用 |
| **python-dotenv** | 环境变量管理 |
| **Pydantic** | 数据验证 |
| **JSON** | 状态持久化 |

---

## ⚠️ 注意事项

1. **API密钥安全**: 请勿将 `.env` 文件提交到版本控制，它已被添加到 `.gitignore`
2. **代理服务**: 默认配置使用 `http://127.0.0.1:8045` 代理，如需直接访问Google API请修改 `config.py`
3. **学习进度**: `learner_state.json` 保存你的学习进度，如需重置请删除此文件

---

## 📝 许可证

本项目采用 [MIT License](LICENSE) 开源协议。

---

<p align="center">
  <strong>🌟 AstraMentor - 让AI成为你的编程导师 🌟</strong>
</p>
